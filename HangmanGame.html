<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hangman Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 400px;
      background: #fff;
      margin: 40px auto;
      padding: 24px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: center;
    }
    #letters button {
      display: inline-block;
      margin: 2px;
      padding: 8px 12px;
      font-size: 16px;
      border: none;
      background: #eee;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
    }
    #letters button:disabled {
      background: #bbb;
      color: #777;
      cursor: not-allowed;
    }
    #answer {
      font-size: 2em;
      letter-spacing: 0.4em;
      margin: 20px 0 12px 0;
    }
    #lives {
      font-size: 1.3em;
      margin: 10px 0;
    }
    #message {
      color: green;
      font-weight: bold;
      margin: 12px 0;
    }
    #restart {
      margin-top: 18px;
      padding: 8px 20px;
      font-size: 14px;
      border-radius: 5px;
      background: #3498db;
      color: #fff;
      border: none;
      cursor: pointer;
      transition: background 0.2s;
    }
    #restart:hover {
      background: #217dbb;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 id="question"></h2>
    <div id="answer"></div>
    <div id="letters"></div>
    <div id="lives"></div>
    <div id="message"></div>
    <button id="restart">Restart</button>
  </div>
  <script>
    const API_URL = "http://codeapi.net.cws18.my-hosting-panel.com/hangman.php";
    const maxLives = 6;
    let question = "";
    let answer = "";
    let masked = [];
    let lives = maxLives;
    let finished = false;

    // DOM elements
    const questionEl = document.getElementById('question');
    const answerEl = document.getElementById('answer');
    const lettersEl = document.getElementById('letters');
    const livesEl = document.getElementById('lives');
    const messageEl = document.getElementById('message');
    const restartBtn = document.getElementById('restart');

    // Fetch questions and start game
    async function startGame() {
      finished = false;
      messageEl.textContent = '';
      lives = maxLives;
      livesEl.textContent = 'Lives: ' + '♥ '.repeat(lives);

      // Fetch questions
      let questionsData;
      try {
        const res = await fetch(API_URL);
        questionsData = await res.json();
      } catch (e) {
        questionEl.textContent = "Could not fetch questions!";
        answerEl.textContent = "";
        lettersEl.innerHTML = "";
        livesEl.textContent = "";
        return;
      }
      // Pick one random Q/A
      const qa = questionsData[Math.floor(Math.random() * questionsData.length)];
      question = qa.Question;
      answer = qa.Answer.toUpperCase();
      masked = Array.from(answer, c => c === ' ' ? ' ' : '_');

      questionEl.textContent = question;
      renderAnswer();
      renderLetters();
      renderLives();
    }

    // Display masked answer
    function renderAnswer() {
      answerEl.textContent = masked.join(' ');
    }

    // Display A-Z buttons
    function renderLetters() {
      lettersEl.innerHTML = "";
      for (let i = 65; i <= 90; i++) {
        const letter = String.fromCharCode(i);
        const btn = document.createElement('button');
        btn.textContent = letter;
        btn.disabled = finished;
        btn.onclick = () => handleGuess(letter, btn);
        lettersEl.appendChild(btn);
      }
    }

    // Handle letter guess
    function handleGuess(letter, btn) {
      if (finished) return;
      btn.disabled = true;
      let found = false;
      for (let i = 0; i < answer.length; i++) {
        if (answer[i] === letter) {
          masked[i] = letter;
          found = true;
        }
      }
      renderAnswer();

      if (!found) {
        lives--;
        renderLives();
        if (lives <= 0) {
          finished = true;
          messageEl.textContent = "Game Over! The answer was: " + answer;
          disableAllLetters();
        }
      } else {
        if (masked.join('') === answer) {
          finished = true;
          messageEl.textContent = "Congratulations! You have won!";
          disableAllLetters();
        }
      }
    }

    // Update lifes display
    function renderLives() {
      livesEl.textContent = 'Lives: ' + '♥ '.repeat(lives);
    }

    // Disable all letter buttons
    function disableAllLetters() {
      Array.from(lettersEl.children).forEach(btn => btn.disabled = true);
    }

    // Restart button
    restartBtn.onclick = startGame;

    // Initial start
    startGame();
  </script>
</body>
</html>
